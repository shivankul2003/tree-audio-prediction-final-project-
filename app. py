import gradio as gr
import librosa
import numpy as np
import joblib

# Load trained model
model = joblib.load("model.pkl")

# Function to predict tree type
def predict_tree(audio_file):
    y, sr = librosa.load(audio_file, sr=None)
    mfcc = librosa.feature.mfcc(y=y, sr=sr, n_mfcc=13)
    features = np.mean(mfcc.T, axis=0).reshape(1, -1)
    prediction = model.predict(features)[0]
    return f"ðŸŒ³ Predicted Tree: {prediction}"

# Gradio Interface
interface = gr.Interface(
    fn=predict_tree,
    inputs=gr.Audio(type="filepath", label="Upload Tree Sound"),
    outputs="text",
    title="SoundTree ðŸŒ³",
    description="Upload a tree sound and get its species prediction."
)

interface.launch()
